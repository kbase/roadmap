#Automated Developer Documentation

##Summary:

Improve our automated documentation systems to provide parity of SDK service
documentation across languages and improve language specific and language
agnostic service documentation.

##Story/Description:

With the advent of the SDK, we hope to attract 3rd party developers to add
functionality to KBase. This requires, among other things, excellent developer
documentation as that is typically the first thing 3rd party developers will
encounter. We plan to allow developers to deploy dynamic services via the SDK.
Service documentation produced by the SDK varies greatly by language:

* Perl - good
* Java - acceptable with some quirks
* Python - none
* Javascript - none
* R - none

The service typespecs themselves provide the only language-neutral service
documentation, but being standard text files, they can be difficult to navigate
and read.

##Approach:

###Improvements to the SDK documentation source format and formatter:

1. Add an enumeration (either a new typedef or via annotation) to the SDK
   service / type definition language (e.g. the KIDL). There must be an
   enumeration for strings. Enumerations for integers and floats may also be
   useful. Add type checking for enumerations to the Workspace type validator.
   Types that are, or are marked as, enumerations may not be null. 
    1. There are many use cases for enumerations - generally, theyâ€™re useful
       for providing controlled vocabularies, but specific use cases that
       already exist in KBase include enumerating possible sequencing
       technologies (e.g. Illumina, IonTorrent, PacBio CCS, PacBio CLR) in the
       Single and PairedEndLibrary types, feature types (e.g.  CDS, promoter,
       siRNA) in the Genome type, sample types (e.g. microarray, RNA-Seq, qPCR)
       in the Expression type, booleans (0, 1), and workspace permissions
       (n, r, w, a).
    2. Enumerations make it explicit to developers what input is allowed for a
       specific field in a type, and workspace type checking means that
       developers using a typed object retrieved from the workspace are
       guaranteed that the value of the enumeration is one of the values
       defined in the typespec, which simplifies error checking.
2. Add a @notnull (or similar) annotation. Currently strings, ints and floats
   will pass typechecking if null (a good and necessary feature). However, in
   many cases null is not an acceptable value and should be excluded.
   Specifically calling this out in the spec as an annotation makes that
   clear to developers. Update the type validator to throw an error when a null
   is encountered for a typedef with a @notnull annotation.
3. Add the ability to comment inside structures. Comments should be associated
   with the following structure field and support the @metadata, @optional,
   @range, @enum (if enumerations are implemented as annotations), @notnull,
   @deprecated, and @id annotations. Currently structures may only be described
   in a single block of text at the top of the structure definition, so
   understanding a structure with many fields entails returning to the text
   block many times (if it even documents the structure members)
   ([example](https://narrative.kbase.us/#spec/type/KBaseFile.PairedEndLibrary)).
   Documentation adjacent to each field is much more readable.
    1. As a side benefit, Java documentation can then provide proper
       documentation for the various getter and setter methods that act on
       structure members.
4. Allow only safe HTML elements (or consider only allowing Markdown).
   Specifically exclude &lt;script> elements, for example.
5. Provide syntax for linking text in comments to typedefs and funcdefs
   (similar in functionality to the Javadoc @link annotation). These links
   should be translated into appropriate idioms for the target document (e.g.
   &lt;a> elements for HTML, @link for java, :py:meth: for python sphinx).


###Improve the autogenerated language specific documentation:

Language|Action
----------------|-----------
All|Incorporate changes for enumerations, notnull, and structure comments as above.
Perl|None
Java|Improve the nearly illegible tuple documentation. One approach is listing the tuple members in the main method text and simply providing a reference to that text (e.g. @param sometuple see definition above) in the parameter and return listings.
Python|Provide parity with Perl documentation via Sphinx autodoc compatible documentation (the standard for Python documentation).
Javascript|Provide parity with Perl documentation using Javascript standard documentation methods.
R|Provide parity with Perl documentation using R standard documentation methods.

Note that adding the Perl-style autogenerated recursive argument structure
documentation to other languages may not be necessary - whether this is
implemented is left up to the implementation team.

###Provide navigable language agnostic documentation:

Add an option to the SDK to produce standalone HTML versions of the
typespec(s), including imported specs, that

* Provides an index of the typedefs and funcdefs (similar to the Perldoc)
* Links typenames to their typedef
* Displays each element of the typespec (e.g. keywords, variable names, type
  names, etc) as per an associated css file. A default css file should be
  generated with reasonable settings (probably matching the type browser).
* Provides anchors for, at minimum, typedefs and funcdefs so that urls can be
  created that link to these Xdefs. The other possible extreme is allowing
  links for every line of the file like GitHub.

##User stories:
No changes would be evident to a bench biologist.

3rd party developers would encounter much improved documentation (especially
for Python, Javascript, and R developers), and said documentation is likely to
strongly influence their first impression of developing with KBase and the SDK.

##Narrative Mockup:

N/A

##Timeline:

Probably 1 sprint, possibly 2.

##Test Plan:

Add appropriate tests to the sdk and workspace test suites. 

##Citations:

N/A
